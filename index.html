<!DOCTYPE html>
<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" rel="stylesheet" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.2.3/leaflet.draw.js"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.2.3/leaflet.draw.css" rel="stylesheet" />
	<meta charset="utf-8">
	<title>Corfu Map</title>
	<style type="text/css">
		body {
			margin: 0;
			padding: 0;
		}
		#map {
			position: absolute;
			top: 0;
			bottom: 0;
			width: 100%;
			z-index:1;
		}
		#delete, #export {
			position: absolute;
			top:50px;
			right:10px;
			z-index:100;
			background:white;
			color:black;
			padding:6px;
			border-radius:4px;
			font-family: 'Helvetica Neue';
			cursor: pointer;
			font-size:12px;
			text-decoration:none;
		}
		#export {
			top:90px;
		}
	</style>
</head>
<body>
  <div id='map'></div>
  <div id='delete'>Delete Features</div>
  <a href='#' id='export'>Export Features</a>
  <script type="text/javascript">
	// center of the map
	var center = [46.165164, 15.750443];

	// Create the map
	var map = L.map('map').setView(center,15);

	// Set up the OSM layer
	L.tileLayer(
	  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		attribution: 'Data Â© <a href="http://osm.org/copyright">OpenStreetMap</a>',
		maxZoom: 18
	  }).addTo(map);

	var featureGroup = L.featureGroup().addTo(map);

	var drawControl = new L.Control.Draw({
		edit: {
			featureGroup: featureGroup
		}
	}).addTo(map);

	map.on('draw:created', function(e) {
		// Each time a feaute is created, it's added to the over arching feature group
		featureGroup.addLayer(e.layer);	
	});

	// on click, clear all layers
	document.getElementById('delete').onclick = function(e) {
		featureGroup.clearLayers();
	}

	document.getElementById('export').onclick = function(e) {
		// Extract GeoJson from featureGroup
		var data = featureGroup.toGeoJSON();

		// Stringify the GeoJson
		var convertedData = 'text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data));

		// Create export
		document.getElementById('export').setAttribute('href', 'data:' + convertedData);
		document.getElementById('export').setAttribute('download','data.geojson');
	}
  </script>
</body>
</html>